(()=>{"use strict";const e=window.React,t=window.wp.blocks,a=window.wp.blockEditor,n=window.wp.components,l=window.wp.element;(0,t.registerBlockType)("bcgovcleanbc/multi-query-content",{edit:({attributes:t,setAttributes:o})=>{const{placeholderText:r,fallbackText:i,paramKeys:c,combinations:m,previewMode:s,previewValues:u,useOrLogic:p}=t,d=(e,t,a)=>{const n=m.map((e=>({...e})));n[e][t]=a,o({combinations:n})},v=m.findIndex((e=>p?c.some((t=>e[t]===u[t])):c.every((t=>e[t]===u[t])))),b=m[v],g=r.replace(/{{\s*value\s*}}/g,b?.value||i);return(0,e.createElement)(l.Fragment,null,(0,e.createElement)(a.InspectorControls,null,(0,e.createElement)(n.PanelBody,{title:"Query Parameters"},c.map(((t,a)=>(0,e.createElement)("div",{key:a},(0,e.createElement)(n.TextControl,{label:`Param Key #${a+1}`,value:t,onChange:e=>((e,t)=>{const a=[...c];a[e]=t;const n=m.map((e=>({...e})));for(let e=0;e<n.length;e++)n[e]=Object.fromEntries(a.map((t=>{var a;return[t,null!==(a=n[e][t])&&void 0!==a?a:""]}))),n[e].value=m[e]?.value||"";o({paramKeys:a,combinations:n,previewValues:{}})})(a,e)}),(0,e.createElement)(n.Button,{isLink:!0,isDestructive:!0,onClick:()=>(e=>{const t=[...c],a=t.splice(e,1)[0],n=m.map((e=>{const t={...e};return delete t[a],t})),l={...u};delete l[a],o({paramKeys:t,combinations:n,previewValues:l})})(a)},"Remove")))),(0,e.createElement)(n.Button,{isPrimary:!0,onClick:()=>o({paramKeys:[...c,""]})},"Add Parameter")),(0,e.createElement)(n.PanelBody,{title:"Value Combinations",initialOpen:!1},m.map(((t,a)=>(0,e.createElement)("div",{key:a,style:{marginBottom:"1em",padding:"0.5em",border:a===v?"2px solid green":"1px solid #ccc",background:a===v?"#eaffea":"transparent"}},c.map((l=>(0,e.createElement)(n.TextControl,{key:l,label:`Value for "${l}"`,value:t[l]||"",onChange:e=>d(a,l,e)}))),(0,e.createElement)(n.TextControl,{label:"Output Value",value:t.value,onChange:e=>d(a,"value",e)}),(0,e.createElement)(n.Button,{isLink:!0,isDestructive:!0,onClick:()=>(e=>{const t=m.map((e=>({...e})));t.splice(e,1),o({combinations:t})})(a)},"Remove Combination")))),(0,e.createElement)(n.Button,{isPrimary:!0,onClick:()=>{const e=m.map((e=>({...e}))),t=Object.fromEntries(c.map((e=>[e,""])));t.value="",o({combinations:[...e,t]})}},"Add Combination")),(0,e.createElement)(n.PanelBody,{title:"Editor Preview",initialOpen:!1},(0,e.createElement)(n.ToggleControl,{label:"Enable Preview Mode",checked:s,onChange:e=>o({previewMode:e})}),(0,e.createElement)(n.ToggleControl,{label:"Use OR Logic (match any)",checked:p,onChange:e=>o({useOrLogic:e})}),s&&c.map((t=>(0,e.createElement)(n.TextControl,{key:t,label:`Preview value for "${t}"`,value:u[t]||"",onChange:e=>((e,t)=>{o({previewValues:{...u,[e]:t}})})(t,e)}))),s&&(0,e.createElement)(n.TextControl,{label:"Fallback Text",value:i,onChange:e=>o({fallbackText:e})}))),(0,e.createElement)("div",{...(0,a.useBlockProps)()},(0,e.createElement)(a.RichText,{tagName:"div",value:s?g:r,onChange:e=>o({placeholderText:e}),placeholder:"Type display content like: Your rebate is: {{value}}"})))},save:()=>null})})();